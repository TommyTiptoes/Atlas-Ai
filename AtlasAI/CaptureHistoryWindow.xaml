<Window x:Class="MinimalApp.CaptureHistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ðŸ“¸ Screenshot History - Atlas AI" Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#FF1E1E1E"
        MinHeight="400" MinWidth="600" ShowInTaskbar="False">
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid.Resources>
            <Style x:Key="ModernButton" TargetType="Button">
                <Setter Property="Background" Value="#FF3C3C3C"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="12,6"/>
                <Setter Property="Margin" Value="0,0,8,0"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="#FF007ACC"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            <Style x:Key="HistoryItemStyle" TargetType="Border">
                <Setter Property="Background" Value="#FF2D2D30"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="12"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="#FF3C3C3C"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Grid.Resources>

        <!-- Header -->
        <Border Grid.Row="0" Background="#FF007ACC" CornerRadius="5" Padding="15" Margin="0,0,0,10">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ“¸ Screenshot History" FontSize="18" FontWeight="Bold" Foreground="White"/>
                    <TextBlock x:Name="ItemCountText" Text=" (0 items)" FontSize="14" Foreground="LightGray" 
                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="RefreshButton" Content="ðŸ”„ Refresh" Style="{StaticResource ModernButton}" 
                            Click="RefreshButton_Click" ToolTip="Refresh history"/>
                    <Button x:Name="ClearHistoryButton" Content="ðŸ—‘ï¸ Clear All" Style="{StaticResource ModernButton}" 
                            Click="ClearHistoryButton_Click" ToolTip="Clear all history"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Search and Filter Bar -->
        <Border Grid.Row="1" Background="#FF2D2D30" CornerRadius="5" Padding="12" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBox x:Name="SearchBox" Grid.Column="0" 
                         Background="#FF3C3C3C" Foreground="White" 
                         BorderBrush="#FF007ACC" BorderThickness="1"
                         Padding="10" FontSize="14" VerticalContentAlignment="Center"
                         TextChanged="SearchBox_TextChanged"
                         Text="Search screenshots..." GotFocus="SearchBox_GotFocus" LostFocus="SearchBox_LostFocus"/>
                
                <Button x:Name="FavoritesButton" Grid.Column="1" Content="â­ Favorites" 
                        Style="{StaticResource ModernButton}" Margin="8,0,0,0"
                        Click="FavoritesButton_Click" ToolTip="Show favorites only"/>
                
                <Button x:Name="RecentButton" Grid.Column="2" Content="ðŸ•’ Recent" 
                        Style="{StaticResource ModernButton}"
                        Click="RecentButton_Click" ToolTip="Show recent items"/>
                
                <Button x:Name="AllButton" Grid.Column="3" Content="ðŸ“‹ All" 
                        Style="{StaticResource ModernButton}"
                        Click="AllButton_Click" ToolTip="Show all items"/>
            </Grid>
        </Border>

        <!-- History Items List -->
        <Border Grid.Row="2" Background="#FF252526" CornerRadius="5" Padding="5">
            <ScrollViewer x:Name="HistoryScroller" VerticalScrollBarVisibility="Auto">
                <StackPanel x:Name="HistoryPanel" Margin="10"/>
            </ScrollViewer>
        </Border>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="#FF2D2D30" CornerRadius="5" Padding="12" Margin="0,10,0,0">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="StorageInfoText" Text="Storage: 0 MB" Foreground="LightGray" FontSize="11"/>
                    <TextBlock Text=" â€¢ " Foreground="Gray" FontSize="11" Margin="8,0"/>
                    <TextBlock x:Name="LastCaptureText" Text="Last capture: Never" Foreground="LightGray" FontSize="11"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="OpenFolderButton" Content="ðŸ“ Open Folder" Style="{StaticResource ModernButton}" 
                            Click="OpenFolderButton_Click" ToolTip="Open captures folder"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Context Menu for History Items -->
        <Grid.ContextMenu>
            <ContextMenu x:Name="ItemContextMenu" Background="#FF2D2D30" Foreground="White">
                <MenuItem x:Name="OpenMenuItem" Header="ðŸ–¼ï¸ Open Image" Click="OpenMenuItem_Click"/>
                <MenuItem x:Name="CopyPathMenuItem" Header="ðŸ“‹ Copy Path" Click="CopyPathMenuItem_Click"/>
                <MenuItem x:Name="AnalyzeMenuItem" Header="ðŸ” AI Analysis" Click="AnalyzeMenuItem_Click"/>
                <Separator/>
                <MenuItem x:Name="FavoriteMenuItem" Header="â­ Toggle Favorite" Click="FavoriteMenuItem_Click"/>
                <MenuItem x:Name="ArchiveMenuItem" Header="ðŸ“¦ Archive" Click="ArchiveMenuItem_Click"/>
                <Separator/>
                <MenuItem x:Name="DeleteMenuItem" Header="ðŸ—‘ï¸ Delete" Click="DeleteMenuItem_Click"/>
            </ContextMenu>
        </Grid.ContextMenu>
    </Grid>
</Window>