<Window x:Class="MinimalApp.ChatWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:MinimalApp.Controls"
        xmlns:local="clr-namespace:MinimalApp.Controls"
        Title="Atlas" Height="850" Width="1100"
        MinWidth="600" MinHeight="400"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="Transparent"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResizeWithGrip"
        ShowInTaskbar="True"
        Icon="atlas.ico">
    
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0" ResizeBorderThickness="8" GlassFrameThickness="0" CornerRadius="0"/>
    </WindowChrome.WindowChrome>
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Theme/Colors.xaml"/>
                <ResourceDictionary Source="Theme/Typography.xaml"/>
                <ResourceDictionary Source="Theme/Controls.xaml"/>
                <ResourceDictionary Source="Theme/ChatTemplates.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
            
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 DIEGETIC HOLOGRAPHIC UI - Avengers-style living AI interface
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            
            <!-- Particle dust brush for volumetric background -->
            <DrawingBrush x:Key="ParticleDustBrush" TileMode="Tile" Viewport="0,0,300,300" ViewportUnits="Absolute">
                <DrawingBrush.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing Brush="#02ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="20,30" RadiusX="1" RadiusY="1"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#03ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="80,120" RadiusX="0.8" RadiusY="0.8"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#02ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="150,60" RadiusX="1.2" RadiusY="1.2"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#01ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="220,180" RadiusX="0.6" RadiusY="0.6"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#02ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="280,90" RadiusX="0.9" RadiusY="0.9"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#03ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="45,250" RadiusX="1.1" RadiusY="1.1"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                        <GeometryDrawing Brush="#01ffffff">
                            <GeometryDrawing.Geometry><EllipseGeometry Center="190,220" RadiusX="0.7" RadiusY="0.7"/></GeometryDrawing.Geometry>
                        </GeometryDrawing>
                    </DrawingGroup>
                </DrawingBrush.Drawing>
            </DrawingBrush>
            
            <!-- Subtle grid parallax brush -->
            <DrawingBrush x:Key="GridParallaxBrush" TileMode="Tile" Viewport="0,0,60,60" ViewportUnits="Absolute" Opacity="0.015">
                <DrawingBrush.Drawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Geometry>
                            <GeometryGroup>
                                <LineGeometry StartPoint="0,0" EndPoint="60,0"/>
                                <LineGeometry StartPoint="0,0" EndPoint="0,60"/>
                            </GeometryGroup>
                        </GeometryDrawing.Geometry>
                        <GeometryDrawing.Pen>
                            <Pen Brush="#22d3ee" Thickness="0.3"/>
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>
                </DrawingBrush.Drawing>
            </DrawingBrush>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ATLAS CORE ANIMATIONS - Now handled by AtlasCoreControl
                 (Removed old storyboards that referenced elements inside the control)
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 PROJECTION STYLES - Holographic message slates
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            
            <!-- Projection slate fade in -->
            <Storyboard x:Key="ProjectionAppear">
                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4">
                    <DoubleAnimation.EasingFunction><CubicEase EasingMode="EaseOut"/></DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" 
                                 From="-30" To="0" Duration="0:0:0.4">
                    <DoubleAnimation.EasingFunction><CubicEase EasingMode="EaseOut"/></DoubleAnimation.EasingFunction>
                </DoubleAnimation>
            </Storyboard>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MINIMAL UI STYLES - Ghost controls
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            
            <Style x:Key="GhostBtn" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="#506080"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Width" Value="36"/>
                <Setter Property="Height" Value="36"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="8" Padding="6">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="bd" Property="Background" Value="#ffffff08"/>
                                    <Setter Property="Foreground" Value="#94a3b8"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <Style x:Key="GlassBtn" TargetType="Button">
                <Setter Property="Background" Value="#ffffff04"/>
                <Setter Property="Foreground" Value="#64748b"/>
                <Setter Property="BorderBrush" Value="#ffffff08"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="14,8"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="bd" Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="8" Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="bd" Property="Background" Value="#ffffff0a"/>
                                    <Setter TargetName="bd" Property="BorderBrush" Value="#22d3ee40"/>
                                    <Setter Property="Foreground" Value="#94a3b8"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Legacy compatibility -->
            <Style x:Key="AccentBtn" TargetType="Button" BasedOn="{StaticResource GlassBtn}"/>
            <Style x:Key="SidebarBtn" TargetType="Button" BasedOn="{StaticResource GhostBtn}"/>
            <Style x:Key="ActionChip" TargetType="Button" BasedOn="{StaticResource GlassBtn}"/>
            <Style x:Key="ModernIconBtn" TargetType="Button" BasedOn="{StaticResource GhostBtn}"/>
            <Style x:Key="ModernActionBtn" TargetType="Button" BasedOn="{StaticResource GlassBtn}"/>
            
            <!-- Override ToolTip to remove yellow accent -->
            <Style TargetType="ToolTip">
                <Setter Property="Background" Value="#1a1a24"/>
                <Setter Property="Foreground" Value="#e2e8f0"/>
                <Setter Property="BorderBrush" Value="#22d3ee40"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="8,4"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ToolTip">
                            <Border Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4" Padding="{TemplateBinding Padding}">
                                <ContentPresenter/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Override ContextMenu to remove yellow hover -->
            <Style TargetType="ContextMenu">
                <Setter Property="Background" Value="#0a0c14"/>
                <Setter Property="BorderBrush" Value="#22d3ee30"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="2"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ContextMenu">
                            <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="6" Padding="{TemplateBinding Padding}">
                                <StackPanel IsItemsHost="True"/>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Override MenuItem to remove yellow hover -->
            <Style TargetType="MenuItem">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="#e2e8f0"/>
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="MenuItem">
                            <Border x:Name="bd" Background="{TemplateBinding Background}" 
                                    Padding="{TemplateBinding Padding}" CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter x:Name="Icon" Content="{TemplateBinding Icon}" 
                                                      VerticalAlignment="Center" Margin="0,0,8,0"/>
                                    <ContentPresenter Grid.Column="1" ContentSource="Header" 
                                                      VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="2" Text="{TemplateBinding InputGestureText}"
                                               Foreground="#64748b" FontSize="11" VerticalAlignment="Center"
                                               Margin="20,0,0,0"/>
                                </Grid>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter TargetName="bd" Property="Background" Value="#22d3ee20"/>
                                    <Setter Property="Foreground" Value="#22d3ee"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter Property="Foreground" Value="#475569"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Invisible/Minimal Scrollbar Style -->
            <Style TargetType="ScrollBar">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Width" Value="6"/>
                <Setter Property="MinWidth" Value="6"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ScrollBar">
                            <Grid Background="Transparent">
                                <Track x:Name="PART_Track" IsDirectionReversed="True">
                                    <Track.Thumb>
                                        <Thumb Background="#22d3ee40" BorderThickness="0">
                                            <Thumb.Template>
                                                <ControlTemplate TargetType="Thumb">
                                                    <Border Background="#22d3ee30" CornerRadius="3"/>
                                                </ControlTemplate>
                                            </Thumb.Template>
                                        </Thumb>
                                    </Track.Thumb>
                                </Track>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    
    <!-- Atlas Core animations are now handled internally by AtlasCoreControl -->

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MAIN STAGE - Dark volumetric environment (not a panel)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <Border CornerRadius="0" ClipToBounds="True">
        <!-- Deep space background with vignette -->
        <Border.Background>
            <RadialGradientBrush Center="0.5,0.5" RadiusX="0.8" RadiusY="0.8">
                <GradientStop Color="#050810" Offset="0"/>
                <GradientStop Color="#020408" Offset="0.6"/>
                <GradientStop Color="#000204" Offset="1"/>
            </RadialGradientBrush>
        </Border.Background>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="56"/>  <!-- New TopNavBar -->
                <RowDefinition Height="*"/>
                <RowDefinition Height="0"/>
            </Grid.RowDefinitions>
            
            <!-- Particle dust layer -->
            <Rectangle Grid.RowSpan="2" Fill="{StaticResource ParticleDustBrush}" Opacity="0.6" IsHitTestVisible="False"/>
            
            <!-- Subtle grid parallax -->
            <Rectangle Grid.RowSpan="2" Fill="{StaticResource GridParallaxBrush}" IsHitTestVisible="False"/>
            
            <!-- Vignette overlay -->
            <Rectangle Grid.RowSpan="2" IsHitTestVisible="False">
                <Rectangle.Fill>
                    <RadialGradientBrush Center="0.5,0.5" RadiusX="0.9" RadiusY="0.9">
                        <GradientStop Color="Transparent" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="0.5"/>
                        <GradientStop Color="#40000000" Offset="0.85"/>
                        <GradientStop Color="#80000000" Offset="1"/>
                    </RadialGradientBrush>
                </Rectangle.Fill>
            </Rectangle>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 NEW TOP NAV BAR - Figma-inspired futuristic design
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <local:TopNavBarControl x:Name="TopNavBar" Grid.Row="0" 
                                    TabChanged="TopNavBar_TabChanged"
                                    MinimizeRequested="TopNavBar_MinimizeRequested"
                                    MaximizeRequested="TopNavBar_MaximizeRequested"
                                    CloseRequested="TopNavBar_CloseRequested"
                                    MouseLeftButtonDown="Header_MouseLeftButtonDown"/>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 LEGACY TITLE BAR - Hidden but preserved for compatibility
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="0" Background="Transparent" MouseLeftButtonDown="Header_MouseLeftButtonDown" Visibility="Collapsed">
                <Grid Margin="16,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Minimal Atlas identifier -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Opacity="0.6">
                        <Ellipse Width="6" Height="6" Fill="#22d3ee" Margin="0,0,8,0"/>
                        <TextBlock Text="ATLAS" FontSize="10" Foreground="#506080" FontWeight="SemiBold" 
                                   FontFamily="Consolas" VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <!-- Center - Provider (clickable) - HIDDEN, access via radial settings -->
                    <Border Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                            Background="Transparent" CornerRadius="4" Padding="12,4" 
                            BorderBrush="Transparent" BorderThickness="0" Cursor="Hand"
                            PreviewMouseLeftButtonDown="ProviderSelector_Click" x:Name="ProviderSelectorBorder"
                            Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="5" Height="5" Fill="#22c55e" Margin="0,0,6,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="ProviderIndicator" Text="AI Provider" FontSize="11" 
                                       Foreground="#64748b" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Voice Provider Popup -->
                    <Popup x:Name="VoiceProviderPopup" PlacementTarget="{Binding ElementName=ProviderSelectorBorder}" 
                           Placement="Bottom" StaysOpen="False" AllowsTransparency="True">
                        <Border Background="#0a0c14" BorderBrush="#22d3ee30" BorderThickness="1" 
                                CornerRadius="8" Padding="8" MinWidth="260">
                            <StackPanel>
                                <TextBlock Text="AI PROVIDER" FontSize="9" Foreground="#506080" 
                                           FontWeight="SemiBold" Margin="8,4,8,8"/>
                                <ListBox x:Name="VoiceProviderList" Background="Transparent" BorderThickness="0"
                                         SelectionChanged="VoiceProviderList_SelectionChanged">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="Padding" Value="12,8"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ListBoxItem">
                                                        <Border x:Name="bd" Background="Transparent" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#ffffff08"/>
                                                            </Trigger>
                                                            <Trigger Property="IsSelected" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#22d3ee20"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                </ListBox>
                                <Rectangle Height="1" Fill="#ffffff08" Margin="0,8"/>
                                <TextBlock Text="VOICE" FontSize="9" Foreground="#506080" FontWeight="SemiBold" Margin="8,4,8,8"/>
                                <ListBox x:Name="VoiceList" Background="Transparent" BorderThickness="0"
                                         MaxHeight="180" SelectionChanged="VoiceList_SelectionChanged">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="Padding" Value="12,6"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="ListBoxItem">
                                                        <Border x:Name="bd" Background="Transparent" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                                            <ContentPresenter/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#ffffff08"/>
                                                            </Trigger>
                                                            <Trigger Property="IsSelected" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#22d3ee20"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                </ListBox>
                                <Button Content="â†» Refresh" Click="RefreshVoicesPopup_Click" 
                                        Background="Transparent" Foreground="#64748b" BorderThickness="0"
                                        Padding="12,6" Margin="0,8,0,0" Cursor="Hand" HorizontalAlignment="Left" FontSize="11"/>
                            </StackPanel>
                        </Border>
                    </Popup>
                    
                    <!-- Window controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button x:Name="FocusModeBtn" Content="â—Ž" FontSize="12" Click="FocusMode_Click" 
                                Style="{StaticResource GhostBtn}" ToolTip="Focus Mode" Width="32" Height="32"/>
                        <Button x:Name="NewChatBtn" Content="+" FontSize="14" Click="NewChat_Click" 
                                Style="{StaticResource GhostBtn}" ToolTip="New chat" Width="32" Height="32"/>
                        <Button x:Name="HistoryBtn" Content="â˜°" FontSize="11" Click="History_Click" 
                                Style="{StaticResource GhostBtn}" ToolTip="History" Width="32" Height="32"/>
                        <Button Content="âš™" FontSize="11" Click="Settings_Click" 
                                Style="{StaticResource GhostBtn}" ToolTip="Settings" Width="32" Height="32"/>
                        <Rectangle Width="1" Height="16" Fill="#ffffff08" Margin="6,0"/>
                        <Button Content="â”€" Click="Minimize_Click" Style="{StaticResource GhostBtn}" FontSize="10" Width="32" Height="32"/>
                        <Button x:Name="FullscreenBtn" Content="â–¡" Click="Fullscreen_Click" Style="{StaticResource GhostBtn}" FontSize="9" Width="32" Height="32"/>
                        <Button Content="âœ•" Click="Close_Click" Style="{StaticResource GhostBtn}" FontSize="10" Width="32" Height="32"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 MAIN STAGE AREA - Diegetic holographic layout
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48" x:Name="SidebarColumn"/>
                    <ColumnDefinition Width="0" x:Name="FileBrowserColumn"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto" x:Name="LensColumn"/>
                    <ColumnDefinition Width="0" x:Name="InspectorColumn"/>
                    <ColumnDefinition Width="0" x:Name="StatusPanelColumn"/>  <!-- New Status Panel -->
                </Grid.ColumnDefinitions>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     STATUS PANEL - Figma-inspired right panel (collapsible)
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <local:StatusPanelControl x:Name="StatusPanel" Grid.Column="5" 
                                          Width="260" Visibility="Collapsed"
                                          QuickActionRequested="StatusPanel_QuickActionRequested"/>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     LEFT SIDEBAR - Explorer Only (other tools in Command Palette)
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Border Grid.Column="0" Background="#0a0c10" BorderBrush="#ffffff08" BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- File Browser Toggle - Only button in sidebar -->
                        <StackPanel Grid.Row="0" Margin="0,12,0,0">
                            <Button x:Name="FilesBtn" Click="SidebarToggle_Click" ToolTip="Files (Ctrl+E)" 
                                    Style="{StaticResource GhostBtn}" Width="40" Height="40" Margin="4,2">
                                <TextBlock Text="ðŸ“" FontSize="18"/>
                            </Button>
                        </StackPanel>
                        
                        <!-- Command Palette hint at bottom -->
                        <StackPanel Grid.Row="2" Margin="0,0,0,12">
                            <Button Click="CommandPalette_Click" ToolTip="Command Palette (Ctrl+K)" 
                                    Style="{StaticResource GhostBtn}" Width="40" Height="40" Margin="4,2">
                                <TextBlock Text="âŒ˜" FontSize="18"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- File Browser Panel -->
                <Border Grid.Column="1" x:Name="FileBrowserPanel" Background="#080a0e" 
                        BorderBrush="#ffffff08" BorderThickness="0,0,1,0" Visibility="Collapsed">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <Grid Grid.Row="0" Margin="12,12,12,8">
                            <TextBlock Text="FILES" FontSize="11" FontWeight="SemiBold" Foreground="#64748b" 
                                       VerticalAlignment="Center"/>
                            <Button Content="âœ•" Click="CloseFileBrowser_Click" HorizontalAlignment="Right"
                                    Style="{StaticResource GhostBtn}" Width="24" Height="24"/>
                        </Grid>
                        
                        <TreeView x:Name="FileTreeView" Grid.Row="1" Background="Transparent" BorderThickness="0"
                                  Foreground="#e2e8f0" Margin="8,0" 
                                  TreeViewItem.Expanded="FileTreeItem_Expanded" 
                                  MouseDoubleClick="FileTreeView_MouseDoubleClick">
                            <TreeView.ItemContainerStyle>
                                <Style TargetType="TreeViewItem">
                                    <Setter Property="Foreground" Value="#e2e8f0"/>
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="Padding" Value="4,2"/>
                                </Style>
                            </TreeView.ItemContainerStyle>
                        </TreeView>
                    </Grid>
                </Border>
                
                <!-- Inspector Panel -->
                <Border x:Name="InspectorPanel" Grid.Column="4" Background="#06080c" 
                        BorderBrush="#ffffff06" BorderThickness="1,0,0,0" Visibility="Collapsed">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="16">
                            <Grid Margin="0,0,0,12">
                                <TextBlock Text="Inspector" FontSize="12" FontWeight="SemiBold" Foreground="#94a3b8"/>
                                <Button x:Name="CloseInspectorBtn" Content="âœ•" Click="CloseInspector_Click" 
                                        HorizontalAlignment="Right" Style="{StaticResource GhostBtn}" Width="24" Height="24"/>
                            </Grid>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     MAIN CONTENT AREA - Atlas Core + Projection + Input
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Chat/Projection Area with Atlas Core in background -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Chat messages on the left -->
                        <Grid Grid.Column="0" Margin="20,20,20,0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- PROJECTION STREAM - Recent messages as holographic slates -->
                            <Grid Grid.Row="0">
                                <!-- Legacy MessagesPanel (hidden, for compatibility) -->
                                <ScrollViewer x:Name="MessagesScroller" Visibility="Collapsed">
                                    <StackPanel x:Name="MessagesPanel"/>
                                </ScrollViewer>
                                
                                <!-- New Projection Stream - Scrollable chat area -->
                                <ScrollViewer x:Name="ProjectionScroller" VerticalScrollBarVisibility="Auto" 
                                              HorizontalScrollBarVisibility="Disabled" Padding="0,0,10,0">
                                    <ItemsControl x:Name="ProjectionStream" Margin="0,0,0,20">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Margin="0,8,40,8" Padding="20,16" 
                                                        MaxWidth="800" HorizontalAlignment="Left"
                                                        Opacity="{Binding Opacity}" RenderTransformOrigin="0,0.5"
                                                        Background="#18101820" CornerRadius="6" BorderThickness="1">
                                                    <Border.RenderTransform>
                                                        <TransformGroup>
                                                            <TranslateTransform X="0"/>
                                                            <SkewTransform AngleY="-0.5"/>
                                                        </TransformGroup>
                                                    </Border.RenderTransform>
                                                    <Border.BorderBrush>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                            <GradientStop Color="#4022d3ee" Offset="0"/>
                                                            <GradientStop Color="#18ffffff" Offset="0.5"/>
                                                            <GradientStop Color="#3022d3ee" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Border.BorderBrush>
                                                    
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                        </Grid.RowDefinitions>
                                                        
                                                        <!-- Header: Sender + Time -->
                                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                                            <Ellipse Width="6" Height="6" Margin="0,0,8,0" VerticalAlignment="Center">
                                                                <Ellipse.Style>
                                                                    <Style TargetType="Ellipse">
                                                                        <Setter Property="Fill" Value="#22d3ee"/>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsUser}" Value="True">
                                                                                <Setter Property="Fill" Value="#8b5cf6"/>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Ellipse.Style>
                                                            </Ellipse>
                                                            <TextBlock Text="{Binding Sender}" FontSize="11" FontWeight="SemiBold" 
                                                                       Foreground="#94a3b8" FontFamily="Consolas"/>
                                                            <TextBlock Text=" Â· " Foreground="#3a4a5a" FontSize="11"/>
                                                            <TextBlock Text="{Binding TimeString}" FontSize="10" 
                                                                       Foreground="#506080" FontFamily="Consolas"/>
                                                        </StackPanel>
                                                        
                                                        <!-- Content - Selectable TextBox with context menu -->
                                                        <TextBox Grid.Row="1" Text="{Binding Content, Mode=OneWay}" TextWrapping="Wrap"
                                                                 FontSize="18" Foreground="#ffffff"
                                                                 FontFamily="Segoe UI Variable, Segoe UI, sans-serif"
                                                                 Background="Transparent" BorderThickness="0" IsReadOnly="True"
                                                                 Cursor="IBeam" Padding="0" FocusVisualStyle="{x:Null}"
                                                                 SelectionBrush="#8022d3ee">
                                                            <TextBox.Style>
                                                                <Style TargetType="TextBox">
                                                                    <Setter Property="Effect">
                                                                        <Setter.Value>
                                                                            <DropShadowEffect Color="#00ffff" BlurRadius="8" ShadowDepth="0" Opacity="0.7"/>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsUser}" Value="True">
                                                                            <Setter Property="Effect">
                                                                                <Setter.Value>
                                                                                    <DropShadowEffect Color="#ff6600" BlurRadius="10" ShadowDepth="0" Opacity="0.8"/>
                                                                                </Setter.Value>
                                                                            </Setter>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBox.Style>
                                                            <TextBox.Resources>
                                                                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="#8022d3ee"/>
                                                                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="#ffffff"/>
                                                                <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" Color="#5022d3ee"/>
                                                            </TextBox.Resources>
                                                            <TextBox.ContextMenu>
                                                                <ContextMenu Background="#0a0c14" BorderBrush="#22d3ee30" BorderThickness="1"
                                                                              Tag="{Binding PlacementTarget, RelativeSource={RelativeSource Self}}">
                                                                    <MenuItem Header="ðŸ“‹ Copy" Command="ApplicationCommands.Copy" Foreground="#e2e8f0"/>
                                                                    <MenuItem Header="ðŸ“‹ Copy All" Click="CopyAllMessage_Click" Foreground="#e2e8f0"
                                                                              Tag="{Binding PlacementTarget, RelativeSource={RelativeSource AncestorType=ContextMenu}}"/>
                                                                    <Separator Background="#22d3ee30"/>
                                                                    <MenuItem Header="ðŸ”— Open Links" Click="OpenLinksInMessage_Click" Foreground="#e2e8f0"
                                                                              Tag="{Binding PlacementTarget, RelativeSource={RelativeSource AncestorType=ContextMenu}}"/>
                                                                </ContextMenu>
                                                            </TextBox.ContextMenu>
                                                        </TextBox>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>
                            </Grid>
                            
                            <!-- Status overlay -->
                            <TextBlock x:Name="StatusText" Text="" FontSize="11" Foreground="#22d3ee" 
                                       HorizontalAlignment="Left" VerticalAlignment="Top" Grid.Row="1"
                                       Margin="0,8,0,0" Visibility="Collapsed" FontFamily="Consolas"/>
                        </Grid>
                        
                        <!-- Atlas Core Control - Living blue intelligence -->
                        <Grid Grid.Column="1" x:Name="AtlasCoreContainer" Width="220" Margin="0,0,40,0"
                              VerticalAlignment="Center" HorizontalAlignment="Center" Height="280"
                              MouseEnter="AtlasCoreContainer_MouseEnter" MouseLeave="AtlasCoreContainer_MouseLeave"
                              RenderTransformOrigin="0.5,0.5">
                            <Grid.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform x:Name="CoreContainerScale" ScaleX="1" ScaleY="1"/>
                                    <TranslateTransform x:Name="CoreContainerTranslate" X="0" Y="0"/>
                                </TransformGroup>
                            </Grid.RenderTransform>
                            
                            <!-- Scan Orbit Control - orbiting scan icons (hidden by default) -->
                            <controls:ScanOrbitControl x:Name="ScanOrbit" Visibility="Collapsed" 
                                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                                       ScanCompleted="ScanOrbit_ScanCompleted"
                                                       ScanStarted="ScanOrbit_ScanStarted"/>
                            
                            <!-- Original particle orb (default) -->
                            <controls:AtlasCoreControl x:Name="AtlasCore" ShowStateLabel="True" Visibility="Visible"/>
                            
                            <!-- New Lottie orb (hidden by default) -->
                            <controls:LottieOrbControl x:Name="LottieOrb" Visibility="Collapsed"/>
                            
                            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                 SUMMONED RADIAL CONTROLS - 8 buttons evenly spaced in circle
                                 Canvas: 280x280, Center: 140,140, Radius: 115, Button: 50x50
                                 Positions calculated for perfect symmetry at 45Â° intervals
                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                            <Canvas x:Name="RadialControlsCanvas" Opacity="1" IsHitTestVisible="True"
                                    Width="280" Height="280" HorizontalAlignment="Center" VerticalAlignment="Center"
                                    Panel.ZIndex="100" RenderTransformOrigin="0.5,0.5">
                                <Canvas.RenderTransform>
                                    <RotateTransform x:Name="RadialCanvasRotation" Angle="0"/>
                                </Canvas.RenderTransform>
                                
                                <!-- 0Â° - Top (Mic) -->
                                <Border x:Name="RadialMicBtn" Canvas.Left="115" Canvas.Top="0" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialMic_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Toggle Mic (Ctrl+Shift+A)">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock Text="ðŸŽ¤" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 45Â° - Top-Right (Mute) -->
                                <Border x:Name="RadialMuteBtn" Canvas.Left="196" Canvas.Top="34" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialMute_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Mute TTS">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock x:Name="RadialMuteIcon" Text="ðŸ”Š" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 90Â° - Right (History) -->
                                <Border x:Name="RadialHistoryBtn" Canvas.Left="230" Canvas.Top="115" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialHistory_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="History (Ctrl+H)">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock Text="ðŸ“œ" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 135Â° - Bottom-Right (Focus) -->
                                <Border x:Name="RadialFocusBtn" Canvas.Left="196" Canvas.Top="196" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialFocus_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Focus Mode (Ctrl+F)">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock x:Name="RadialFocusIcon" Text="ðŸŽ¯" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 180Â° - Bottom (Settings) -->
                                <Border x:Name="RadialSettingsBtn" Canvas.Left="115" Canvas.Top="230" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialSettings_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Settings">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock Text="âš™" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 225Â° - Bottom-Left (Wake Word) -->
                                <Border x:Name="RadialWakeBtn" Canvas.Left="34" Canvas.Top="196" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialWake_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Wake Word Toggle">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock x:Name="RadialWakeIcon" Text="ðŸ‘‚" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 270Â° - Left (Command Palette) -->
                                <Border x:Name="RadialCommandBtn" Canvas.Left="0" Canvas.Top="115" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialCommand_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Command Palette (Ctrl+K)">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock Text="âŒ˜" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                
                                <!-- 315Â° - Top-Left (Orb Style) -->
                                <Border x:Name="RadialOrbStyleBtn" Canvas.Left="34" Canvas.Top="34" Width="50" Height="50"
                                        CornerRadius="25" BorderBrush="#22d3ee" BorderThickness="2"
                                        Cursor="Hand" MouseLeftButtonDown="RadialOrbStyle_Click"
                                        RenderTransformOrigin="0.5,0.5" ToolTip="Change Orb Style">
                                    <Border.Background>
                                        <RadialGradientBrush GradientOrigin="0.5,0.5" Center="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                            <GradientStop Color="#20101820" Offset="0"/>
                                            <GradientStop Color="#30101820" Offset="0.6"/>
                                            <GradientStop Color="#10000000" Offset="1"/>
                                        </RadialGradientBrush>
                                    </Border.Background>
                                    <Border.RenderTransform><ScaleTransform ScaleX="1" ScaleY="1"/></Border.RenderTransform>
                                    <Border.Effect>
                                        <DropShadowEffect Color="#22d3ee" BlurRadius="15" ShadowDepth="0" Opacity="0.6"/>
                                    </Border.Effect>
                                    <TextBlock x:Name="RadialOrbStyleIcon" Text="ðŸ”®" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </Canvas>
                            
                            <!-- Status indicators below core -->
                            <StackPanel VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,-30">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock x:Name="StatusLabel" Text="ONLINE" FontSize="9" Foreground="#22c55e" FontFamily="Consolas">
                                        <TextBlock.Effect>
                                            <DropShadowEffect Color="#22c55e" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <TextBlock x:Name="WakeWordIndicator" Text=" Â· LISTENING" FontSize="9" 
                                               Foreground="#22d3ee" Visibility="Collapsed" FontFamily="Consolas">
                                        <TextBlock.Effect>
                                            <DropShadowEffect Color="#22d3ee" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <TextBlock x:Name="HearingIndicator" Text=" Â· HEARING" FontSize="9" 
                                               Foreground="#f59e0b" Visibility="Collapsed" FontFamily="Consolas">
                                        <TextBlock.Effect>
                                            <DropShadowEffect Color="#f59e0b" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <TextBlock x:Name="SpeakingIndicator" Text=" Â· SPEAKING" FontSize="9" 
                                               Foreground="#8b5cf6" Visibility="Collapsed" FontFamily="Consolas">
                                        <TextBlock.Effect>
                                            <DropShadowEffect Color="#8b5cf6" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    
                    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         INPUT INJECTION - Minimal, appears on focus
                    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                    <Border Grid.Row="1" Margin="20,0,20,30">
                        <StackPanel MaxWidth="800" HorizontalAlignment="Left">
                            
                            <!-- Dropped Files -->
                            <Border x:Name="DroppedFilesPanel" Visibility="Collapsed" Background="#ffffff04" 
                                    CornerRadius="8" Margin="0,0,0,8" Padding="10" BorderBrush="#ffffff08" BorderThickness="1">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ItemsControl x:Name="DroppedFilesList">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate><WrapPanel Orientation="Horizontal"/></ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                    </ItemsControl>
                                    <Button Grid.Column="1" Content="âœ•" Click="ClearDroppedFiles_Click" 
                                            Style="{StaticResource GhostBtn}" Width="24" Height="24"/>
                                </Grid>
                            </Border>
                            
                            <!-- Main Input - Injection style -->
                            <Border Background="#0a0c14" CornerRadius="8" BorderBrush="#22d3ee20" BorderThickness="1"
                                    x:Name="InputBorder" AllowDrop="True" DragEnter="InputArea_DragEnter" 
                                    DragOver="InputArea_DragOver" Drop="InputArea_Drop" DragLeave="InputArea_DragLeave">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Left controls -->
                                    <StackPanel Orientation="Horizontal" Margin="10,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="â€º" Foreground="#22d3ee" FontSize="18" FontWeight="Bold" 
                                                   VerticalAlignment="Center" Margin="0,0,6,0"/>
                                        <Button x:Name="AttachButton" Click="AttachButton_Click" ToolTip="Attach" Margin="0,0,4,0">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="bd" Background="Transparent" Padding="4" Cursor="Hand">
                                                        <TextBlock Text="ðŸ“Ž" FontSize="13" Foreground="#506080"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="bd" Property="Background" Value="#ffffff08"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                        <Button x:Name="MicButton" Click="MicButton_Click" ToolTip="Voice">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border x:Name="bd" Background="Transparent" Padding="4" Cursor="Hand">
                                                        <Grid>
                                                            <Ellipse x:Name="MicGlow" Width="20" Height="20" Opacity="0">
                                                                <Ellipse.Fill>
                                                                    <RadialGradientBrush>
                                                                        <GradientStop Color="#22d3ee40" Offset="0"/>
                                                                        <GradientStop Color="Transparent" Offset="1"/>
                                                                    </RadialGradientBrush>
                                                                </Ellipse.Fill>
                                                            </Ellipse>
                                                            <TextBlock Text="ðŸŽ¤" FontSize="13" Foreground="#506080" 
                                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Grid>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter TargetName="bd" Property="Background" Value="#ffffff08"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                    
                                    <!-- Text Input -->
                                    <TextBox x:Name="InputBox" Grid.Column="1" Background="Transparent" 
                                             Foreground="#e2e8f0" BorderThickness="0" FontSize="14" 
                                             FontFamily="Consolas" Padding="8,10" VerticalAlignment="Center" 
                                             KeyDown="InputBox_KeyDown" TextChanged="InputBox_TextChanged" 
                                             CaretBrush="#22d3ee" AcceptsReturn="False" TextWrapping="Wrap"
                                             MaxHeight="100" VerticalScrollBarVisibility="Auto"
                                             AllowDrop="True" IsUndoEnabled="True">
                                        <TextBox.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem Header="Cut" Command="ApplicationCommands.Cut"/>
                                                <MenuItem Header="Copy" Command="ApplicationCommands.Copy"/>
                                                <MenuItem Header="Paste" Command="ApplicationCommands.Paste"/>
                                                <Separator/>
                                                <MenuItem Header="Select All" Command="ApplicationCommands.SelectAll"/>
                                            </ContextMenu>
                                        </TextBox.ContextMenu>
                                        <TextBox.Style>
                                            <Style TargetType="TextBox">
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="">
                                                        <Setter Property="Background">
                                                            <Setter.Value>
                                                                <VisualBrush Stretch="None" AlignmentX="Left">
                                                                    <VisualBrush.Visual>
                                                                        <TextBlock Text="Inject command..." 
                                                                                   Foreground="#3a4a5a" Margin="8,0,0,0"
                                                                                   FontSize="14" FontFamily="Consolas"/>
                                                                    </VisualBrush.Visual>
                                                                </VisualBrush>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBox.Style>
                                    </TextBox>
                                    
                                    <!-- Send Button -->
                                    <Button x:Name="SendButton" Grid.Column="2" Click="SendButton_Click" Margin="6" Cursor="Hand">
                                        <Button.Template>
                                            <ControlTemplate TargetType="Button">
                                                <Border x:Name="bd" Background="#0e7490" CornerRadius="6" Padding="10,6">
                                                    <TextBlock Text="âŽ" Foreground="#ecfeff" FontSize="12" FontWeight="Bold"/>
                                                </Border>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter TargetName="bd" Property="Background" Value="#0891b2"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Button.Template>
                                    </Button>
                                    
                                    <!-- Drop Overlay -->
                                    <Border x:Name="DropOverlay" Grid.ColumnSpan="3" Background="#0e749030" 
                                            CornerRadius="8" Visibility="Collapsed" IsHitTestVisible="False">
                                        <TextBlock Text="Drop files" Foreground="#22d3ee" FontSize="11" 
                                                   FontFamily="Consolas" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </Grid>
                            </Border>
                            
                            <!-- Summoned tools strip (appears when relevant) -->
                            <StackPanel x:Name="ToolStrip" Orientation="Horizontal" Margin="0,8,0,0" Visibility="Collapsed">
                                <Button x:Name="StopSpeechBtn" Click="StopSpeechBtn_Click" Visibility="Collapsed" Margin="0,0,6,0">
                                    <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                            <Border x:Name="bd" Background="#7f1d1d" BorderBrush="#ef4444" BorderThickness="1" 
                                                    CornerRadius="4" Padding="10,4" Cursor="Hand">
                                                <TextBlock Text="â–  Stop" Foreground="#fca5a5" FontSize="11"/>
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter TargetName="bd" Property="Background" Value="#991b1b"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Button.Template>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>
                
                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     RIGHT: HISTORY DRAWER - Full conversation history
                â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Grid Grid.Column="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition x:Name="HistoryDrawerColumn" Width="0"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- History Drawer Panel -->
                    <Border x:Name="HistoryDrawerPanel" Grid.Column="0" Background="#06080c"
                            BorderBrush="#22d3ee15" BorderThickness="1,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Header -->
                            <Border Grid.Row="0" Background="#0a0c14" Padding="16,12" BorderBrush="#ffffff06" BorderThickness="0,0,0,1">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="â—·" FontSize="14" Foreground="#22d3ee" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                        <TextBlock Text="HISTORY" FontSize="11" FontWeight="SemiBold" 
                                                   Foreground="#94a3b8" FontFamily="Consolas" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <Button Content="âœ•" Click="CloseHistoryDrawer_Click" HorizontalAlignment="Right"
                                            Style="{StaticResource GhostBtn}" Width="28" Height="28" ToolTip="Close"/>
                                </Grid>
                            </Border>
                            
                            <!-- Full History List -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="8">
                                <ItemsControl x:Name="HistoryList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Button Margin="4,4" Padding="0" Cursor="Hand"
                                                    Click="HistoryItemButton_Click" Tag="{Binding}"
                                                    Background="Transparent" BorderThickness="0">
                                                <Button.Template>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border x:Name="bd" Padding="12,10" Background="#20ffffff" CornerRadius="6">
                                                            <ContentPresenter/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#40ffffff"/>
                                                            </Trigger>
                                                            <DataTrigger Binding="{Binding IsUser}" Value="True">
                                                                <Setter TargetName="bd" Property="Background" Value="#308b5cf6"/>
                                                            </DataTrigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Button.Template>
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="*"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <!-- Header -->
                                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                                                        <Ellipse Width="5" Height="5" Margin="0,0,6,0" VerticalAlignment="Center">
                                                            <Ellipse.Style>
                                                                <Style TargetType="Ellipse">
                                                                    <Setter Property="Fill" Value="#22d3ee"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsUser}" Value="True">
                                                                            <Setter Property="Fill" Value="#8b5cf6"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Ellipse.Style>
                                                        </Ellipse>
                                                        <TextBlock Text="{Binding Sender}" FontSize="10" FontWeight="SemiBold" 
                                                                   Foreground="#64748b" FontFamily="Consolas"/>
                                                        <TextBlock Text=" Â· " Foreground="#3a4a5a" FontSize="10"/>
                                                        <TextBlock Text="{Binding TimeString}" FontSize="9" 
                                                                   Foreground="#506080" FontFamily="Consolas"/>
                                                    </StackPanel>
                                                    
                                                    <!-- Content preview -->
                                                    <TextBlock Grid.Row="1" Text="{Binding Content}" TextWrapping="Wrap"
                                                               TextTrimming="CharacterEllipsis" MaxHeight="60"
                                                               FontSize="12" Foreground="#94a3b8" LineHeight="18"/>
                                                </Grid>
                                            </Button>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                    
                    <!-- History Toggle Button -->
                    <Button x:Name="HistoryToggleBtn" Grid.Column="1" Click="HistoryDrawerToggle_Click" 
                            ToolTip="Chat History" Width="36" Cursor="Hand" VerticalAlignment="Stretch">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="bd" Background="#06080c" BorderThickness="1,0,0,0" BorderBrush="#ffffff06">
                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock x:Name="arrow" Text="â—€" FontSize="11" Foreground="#506080" HorizontalAlignment="Center"/>
                                        <TextBlock Text="H" FontSize="9" Foreground="#3a4a5a" HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                        <TextBlock Text="I" FontSize="9" Foreground="#3a4a5a" HorizontalAlignment="Center"/>
                                        <TextBlock Text="S" FontSize="9" Foreground="#3a4a5a" HorizontalAlignment="Center"/>
                                        <TextBlock Text="T" FontSize="9" Foreground="#3a4a5a" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="bd" Property="Background" Value="#0a0c14"/>
                                        <Setter TargetName="bd" Property="BorderBrush" Value="#22d3ee30"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Grid>
                
                <!-- Legacy panels (hidden) - FileBrowserPanel moved to Grid.Column="0" at top -->
                <Button x:Name="SidebarToggleBtn" Click="SidebarToggle_Click" Visibility="Collapsed"/>
                <TreeView x:Name="FileTreeViewLegacy" Visibility="Collapsed" TreeViewItem.Expanded="FileTreeItem_Expanded" MouseDoubleClick="FileTreeView_MouseDoubleClick"/>
                
                <!-- Inspector Panel moved to Grid.Column="4" at top of main Grid -->
            </Grid>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 HIDDEN ELEMENTS - Preserved for compatibility (inside a Grid)
            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid Grid.Row="2" Visibility="Collapsed">
                <StackPanel>
                    <ComboBox x:Name="VoiceSelector" SelectionChanged="VoiceSelector_Changed"/>
                    <ToggleButton x:Name="SpeechToggle" Click="SpeechToggle_Click"/>
                    <ToggleButton x:Name="WakeWordToggle" Click="WakeWordToggle_Click"/>
                    <Button x:Name="AudioProtectionBtn" Click="AudioProtection_Click"/>
                    <Button x:Name="RefreshVoicesBtn" Click="RefreshVoices_Click"/>
                    <Button x:Name="CaptureButton" Click="CaptureButton_Click"/>
                    <Button x:Name="HistoryButton" Click="HistoryButton_Click"/>
                    <Button x:Name="MemoryBtn" Click="Memory_Click"/>
                    <Button x:Name="ShowInspectorBtn" Click="ShowInspector_Click"/>
                    <Button x:Name="StopVoiceBtn" Click="StopVoice_Click"/>
                    <Button x:Name="DeleteHistoryBtn" Click="DeleteHistory_Click"/>
                    <Popup x:Name="SuggestionsPopup" StaysOpen="False" AllowsTransparency="True">
                        <ListBox x:Name="SuggestionsList" SelectionChanged="Suggestion_Selected"/>
                    </Popup>
                    
                    <!-- Quick action buttons -->
                    <Button Tag="search" Click="QuickAction_Click"/>
                    <Button Tag="code" Click="QuickAction_Click"/>
                    <Button Tag="write" Click="QuickAction_Click"/>
                    <Button Click="SecuritySuite_Click"/>
                    <Button Click="Uninstaller_Click"/>
                    
                    <!-- Avatar buttons -->
                    <Button x:Name="DefaultAvatarBtn"/>
                    <Button x:Name="EnergeticAvatarBtn"/>
                    <Button x:Name="CalmAvatarBtn"/>
                    <Button x:Name="ReadyPlayerAvatarBtn"/>
                    
                    <!-- Toast container -->
                    <StackPanel x:Name="ToastContainer"/>
                    
                    <!-- Context inspector elements -->
                    <TextBlock x:Name="ContextAppIcon"/>
                    <TextBlock x:Name="ContextAppName"/>
                    <TextBlock x:Name="ContextProcessName"/>
                    <TextBlock x:Name="ContextFilePath"/>
                    <TextBlock x:Name="ContextWindowTitle"/>
                    
                    <!-- Security panel elements -->
                    <Border x:Name="SecurityBadge"/>
                    <TextBlock x:Name="SecurityStatusText"/>
                    <TextBlock x:Name="LastScanText"/>
                    <TextBlock x:Name="DefinitionsText"/>
                    
                    <!-- Voice settings sliders -->
                    <Slider x:Name="StabilitySlider" ValueChanged="StabilitySlider_ValueChanged"/>
                    <Slider x:Name="SimilaritySlider" ValueChanged="SimilaritySlider_ValueChanged"/>
                    <Slider x:Name="StyleSlider" ValueChanged="StyleSlider_ValueChanged"/>
                    <ToggleButton x:Name="SpeakerBoostToggle" Click="SpeakerBoostToggle_Click"/>
                    <TextBlock x:Name="StabilityValueText"/>
                    <TextBlock x:Name="SimilarityValueText"/>
                    <TextBlock x:Name="StyleValueText"/>
                    
                    <!-- Legacy orb elements -->
                    <Grid x:Name="OrbContainer"/>
                    <Ellipse x:Name="OrbGlow"/>
                    <Ellipse x:Name="OrbCore"/>
                    <Ellipse x:Name="ListeningRing1"/>
                    <Ellipse x:Name="ListeningRing2"/>
                    <Rectangle x:Name="ScanLine"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</Window>
