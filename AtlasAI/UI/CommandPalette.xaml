<Window x:Class="AtlasAI.UI.CommandPalette"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Command Palette"
        Width="500" Height="400"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        Topmost="True"
        KeyDown="Window_KeyDown"
        Deactivated="Window_Deactivated">
    
    <Border Background="#0d1117" CornerRadius="12" BorderBrush="#30363d" BorderThickness="1"
            Margin="20">
        <Border.Effect>
            <DropShadowEffect Color="#000000" BlurRadius="24" ShadowDepth="8" Opacity="0.5"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Search Box -->
            <Border Grid.Row="0" Background="#161b22" CornerRadius="12,12,0,0" 
                    BorderBrush="#30363d" BorderThickness="0,0,0,1" Padding="16,12">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="ðŸ”" FontSize="16" Foreground="#6e7681" 
                               VerticalAlignment="Center" Margin="0,0,12,0"/>
                    
                    <TextBox x:Name="SearchBox" Grid.Column="1" 
                             Background="Transparent" Foreground="#e6edf3"
                             BorderThickness="0" FontSize="15" 
                             CaretBrush="#00d4ff" VerticalAlignment="Center"
                             TextChanged="SearchBox_TextChanged">
                        <TextBox.Style>
                            <Style TargetType="TextBox">
                                <Style.Triggers>
                                    <Trigger Property="Text" Value="">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <VisualBrush Stretch="None" AlignmentX="Left">
                                                    <VisualBrush.Visual>
                                                        <TextBlock Text="Type a command or search..." 
                                                                   Foreground="#484f58" FontSize="15"/>
                                                    </VisualBrush.Visual>
                                                </VisualBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>
                    
                    <TextBlock Grid.Column="2" Text="ESC" FontSize="10" 
                               Foreground="#6e7681" VerticalAlignment="Center"
                               Padding="6,3" Background="#21262d">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Opacity" Value="0.7"/>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </Border>
            
            <!-- Results List -->
            <ListBox x:Name="ResultsList" Grid.Row="1" Background="Transparent" 
                     BorderThickness="0" Padding="8" 
                     SelectionChanged="ResultsList_SelectionChanged"
                     MouseDoubleClick="ResultsList_MouseDoubleClick"
                     PreviewMouseLeftButtonUp="ResultsList_MouseLeftButtonUp">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="#8b949e"/>
                        <Setter Property="Padding" Value="12,10"/>
                        <Setter Property="Margin" Value="0,2"/>
                        <Setter Property="Cursor" Value="Hand"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border x:Name="bd" Background="{TemplateBinding Background}"
                                            CornerRadius="6" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="bd" Property="Background" Value="#21262d"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="bd" Property="Background" Value="#00d4ff20"/>
                                            <Setter Property="Foreground" Value="#e6edf3"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Text="{Binding Icon}" FontSize="16" 
                                       VerticalAlignment="Center" Margin="0,0,12,0"/>
                            
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="{Binding Name}" FontSize="14" 
                                           Foreground="#e6edf3"/>
                                <TextBlock Text="{Binding Description}" FontSize="11" 
                                           Foreground="#6e7681" Margin="0,2,0,0"
                                           Visibility="{Binding HasDescription, Converter={StaticResource BoolToVisibility}}"/>
                            </StackPanel>
                            
                            <TextBlock Grid.Column="2" Text="{Binding Shortcut}" 
                                       FontSize="10" Foreground="#6e7681"
                                       VerticalAlignment="Center" Padding="6,3"
                                       Background="#21262d"
                                       Visibility="{Binding HasShortcut, Converter={StaticResource BoolToVisibility}}"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>
    </Border>
</Window>